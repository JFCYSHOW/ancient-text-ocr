<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤ç±ç ”ç©¶æ™ºèƒ½å·¥ä½œæµç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 50%, #fecaca 100%);
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(90deg, #1e293b 0%, #92400e 100%);
            color: white;
            padding: 24px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: bold;
        }

        .header p {
            color: #fde68a;
            font-size: 14px;
            margin-top: 4px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 24px;
        }

        .tabs {
            background: white;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-bottom: 2px solid #fde68a;
            display: flex;
            overflow: hidden;
        }

        .tab {
            flex: 1;
            padding: 16px 24px;
            background: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            color: #6b7280;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #fef3c7;
        }

        .tab.active {
            background: linear-gradient(90deg, #f59e0b 0%, #f97316 100%);
            color: white;
        }

        .tab-content {
            background: white;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 32px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .upload-area {
            border: 3px dashed #f59e0b;
            border-radius: 12px;
            padding: 48px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 24px;
        }

        .upload-area:hover {
            background: #fef3c7;
            border-color: #92400e;
        }

        .upload-area input {
            display: none;
        }

        .preview-image {
            max-width: 100%;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 2px solid #fde68a;
            margin: 16px 0;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(90deg, #f59e0b 0%, #f97316 100%);
            color: white;
            width: 100%;
            margin-top: 16px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }

        .btn-primary:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #f59e0b;
            color: white;
            margin: 4px;
        }

        .btn-secondary:hover {
            background: #92400e;
        }

        textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid #fde68a;
            border-radius: 8px;
            font-size: 16px;
            line-height: 1.8;
            resize: vertical;
            font-family: "Noto Serif SC", "STSong", serif;
        }

        textarea:focus {
            outline: none;
            border-color: #f59e0b;
        }

        .search-box {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }

        .search-box input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #fde68a;
            border-radius: 8px;
            font-size: 16px;
        }

        .search-box input:focus {
            outline: none;
            border-color: #f59e0b;
        }

        .result-card {
            border: 2px solid #fde68a;
            border-radius: 12px;
            padding: 24px;
            margin: 16px 0;
            background: linear-gradient(90deg, white 0%, #fef3c7 100%);
            transition: all 0.3s;
        }

        .result-card:hover {
            box-shadow: 0 6px 12px rgba(0,0,0,0.1);
        }

        .info-box {
            background: #fef3c7;
            border: 1px solid #fde68a;
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 48px;
            color: #92400e;
        }

        .spinner {
            border: 4px solid #fde68a;
            border-top: 4px solid #f59e0b;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .comparison-result {
            margin-top: 24px;
        }

        .diff-item {
            background: white;
            border: 1px solid #fca5a5;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 8px;
        }

        .badge-error {
            background: #fca5a5;
            color: #7f1d1d;
        }

        .badge-success {
            background: #86efac;
            color: #14532d;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div>
                <h1>ğŸ“š å¤ç±ç ”ç©¶æ™ºèƒ½å·¥ä½œæµç³»ç»Ÿ</h1>
                <p>æ¸…ä»£å¤ç±ä¸“ä¸šå·¥å…· | OCRè¯†åˆ« Â· æ–‡çŒ®æŸ¥è¯¢ Â· æ™ºèƒ½æ ¡å¯¹</p>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab active" onclick="switchTab('ocr')">ğŸ“¤ æ­¥éª¤1ï¼šOCRè¯†åˆ«</button>
            <button class="tab" onclick="switchTab('search')">ğŸ” æ­¥éª¤2ï¼šæŸ¥è¯¢å‡ºå¤„</button>
            <button class="tab" onclick="switchTab('compare')">âœ… æ­¥éª¤3ï¼šæ™ºèƒ½æ ¡å¯¹</button>
        </div>

        <!-- OCRè¯†åˆ«æ ‡ç­¾é¡µ -->
        <div id="ocr-tab" class="tab-content active">
            <div class="grid">
                <div>
                    <h3 style="color: #92400e; margin-bottom: 16px;">ä¸Šä¼ å¤ç±å›¾ç‰‡</h3>
                    <label class="upload-area" for="image-upload">
                        <input type="file" id="image-upload" accept="image/*" onchange="handleImageUpload(event)">
                        <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“¤</div>
                        <p style="font-size: 18px; color: #92400e; margin-bottom: 8px;">ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡</p>
                        <p style="font-size: 14px; color: #78350f;">æ”¯æŒç«–æ’ã€ç¹ä½“ã€æ¸…ä»£å­—ä½“</p>
                    </label>
                    
                    <img id="preview" class="preview-image hidden" alt="é¢„è§ˆ">
                    
                    <button id="recognize-btn" class="btn btn-primary hidden" onclick="recognizeText()">
                        ğŸ” å¼€å§‹è¯†åˆ«
                    </button>

                    <div class="info-box">
                        <h4 style="color: #92400e; margin-bottom: 8px;">âœ¨ ä¸“ä¸šåŠŸèƒ½</h4>
                        <ul style="color: #78350f; font-size: 14px; line-height: 1.8; list-style-position: inside;">
                            <li>â€¢ æ™ºèƒ½è¯†åˆ«ç«–æ’å¤æ–‡</li>
                            <li>â€¢ ç²¾å‡†å¤„ç†ç¹ä½“ã€å¼‚ä½“å­—</li>
                            <li>â€¢ ä¿ç•™åŸæ–‡æ ¼å¼</li>
                            <li>â€¢ è¯†åˆ«æ‰¹æ³¨å’Œå°ç« </li>
                        </ul>
                    </div>
                </div>

                <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="color: #92400e;">è¯†åˆ«ç»“æœ</h3>
                        <div id="ocr-actions" class="hidden">
                            <button class="btn btn-secondary" onclick="copyText('ocr-result')">ğŸ“‹ å¤åˆ¶</button>
                            <button class="btn btn-secondary" onclick="switchTab('search')">ä¸‹ä¸€æ­¥ â†’</button>
                        </div>
                    </div>
                    <textarea id="ocr-result" rows="20" placeholder="è¯†åˆ«çš„å¤æ–‡å°†æ˜¾ç¤ºåœ¨è¿™é‡Œï¼Œå¯æ‰‹åŠ¨ç¼–è¾‘..."></textarea>
                </div>
            </div>
        </div>

        <!-- æŸ¥è¯¢å‡ºå¤„æ ‡ç­¾é¡µ -->
        <div id="search-tab" class="tab-content">
            <h3 style="color: #92400e; margin-bottom: 16px;">æŸ¥è¯¢æ–‡çŒ®å‡ºå¤„</h3>
            
            <div class="search-box">
                <input type="text" id="search-input" placeholder="è¾“å…¥å…³é”®æ–‡å­—æˆ–å¼•æ–‡ï¼ŒæŸ¥è¯¢å‡ºå¤„..." onkeypress="if(event.key==='Enter') searchLiterature()">
                <button class="btn btn-secondary" onclick="searchLiterature()">ğŸ” æœç´¢</button>
            </div>

            <div class="info-box">
                <h4 style="color: #2563eb; margin-bottom: 8px;">ğŸ“š æ”¯æŒçš„æ•°æ®åº“</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px; font-size: 14px; color: #1e40af;">
                    <div>âœ“ ä¸­å›½å“²å­¦ä¹¦ç”µå­åŒ–è®¡åˆ’</div>
                    <div>âœ“ å›½å­¦å¤§å¸ˆ</div>
                    <div>âœ“ ç»´åŸºæ–‡åº“</div>
                    <div>âœ“ æ®†çŸ¥é˜å¤ä»£æ–‡çŒ®</div>
                    <div>âœ“ ä¹¦æ ¼æ•°å­—å¤ç±</div>
                    <div>âœ“ å››åº“å…¨ä¹¦ç”µå­ç‰ˆ</div>
                    <div>âœ“ æ¸…å®å½•</div>
                    <div>âœ“ æ›´å¤šæ•°æ®åº“...</div>
                </div>
            </div>

            <div id="search-loading" class="loading hidden">
                <div class="spinner"></div>
                <p>æ­£åœ¨å¤šæ•°æ®åº“æ£€ç´¢...</p>
            </div>

            <div id="search-results"></div>
        </div>

        <!-- æ™ºèƒ½æ ¡å¯¹æ ‡ç­¾é¡µ -->
        <div id="compare-tab" class="tab-content">
            <h3 style="color: #92400e; margin-bottom: 16px;">æ™ºèƒ½æ¯”å¯¹æ ¡å¯¹</h3>
            
            <div class="grid">
                <div>
                    <label style="display: block; font-weight: bold; color: #92400e; margin-bottom: 8px;">åŸå›¾è¯†åˆ«æ–‡æœ¬ï¼ˆæ ‡å‡†ï¼‰</label>
                    <textarea id="compare-source" rows="12" readonly placeholder="è¯·å…ˆåœ¨OCRè¯†åˆ«æ ‡ç­¾é¡µè¯†åˆ«å›¾ç‰‡..." style="background: #f0fdf4; border-color: #86efac;"></textarea>
                </div>
                <div>
                    <label style="display: block; font-weight: bold; color: #92400e; margin-bottom: 8px;">å¾…æ ¡å¯¹æ–‡æœ¬</label>
                    <textarea id="compare-target" rows="12" placeholder="ç²˜è´´éœ€è¦æ ¡å¯¹çš„æ–‡æœ¬..."></textarea>
                </div>
            </div>

            <button class="btn btn-primary" onclick="compareTexts()" style="margin-top: 24px;">
                âœ… å¼€å§‹æ™ºèƒ½æ¯”å¯¹
            </button>

            <div id="compare-loading" class="loading hidden">
                <div class="spinner"></div>
                <p>AIåˆ†æä¸­...</p>
            </div>

            <div id="comparison-result" class="comparison-result hidden"></div>
        </div>
    </div>

    <script>
        let imageData = null;

        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µ
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');

            // å¦‚æœåˆ‡æ¢åˆ°æ¯”å¯¹é¡µï¼Œè‡ªåŠ¨å¡«å……OCRç»“æœ
            if (tabName === 'compare') {
                const ocrResult = document.getElementById('ocr-result').value;
                document.getElementById('compare-source').value = ocrResult;
            }
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                imageData = e.target.result;
                const preview = document.getElementById('preview');
                preview.src = imageData;
                preview.classList.remove('hidden');
                document.getElementById('recognize-btn').classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }

        async function recognizeText() {
            if (!imageData) return;

            const btn = document.getElementById('recognize-btn');
            btn.disabled = true;
            btn.innerHTML = '<div class="spinner" style="width: 20px; height: 20px; display: inline-block; vertical-align: middle;"></div> AIè¯†åˆ«ä¸­...';

            try {
                const base64Data = imageData.split(',')[1];
                
                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 2000,
                        messages: [{
                            role: 'user',
                            content: [
                                {
                                    type: 'image',
                                    source: {
                                        type: 'base64',
                                        media_type: 'image/jpeg',
                                        data: base64Data
                                    }
                                },
                                {
                                    type: 'text',
                                    text: 'è¿™æ˜¯ä¸€å¼ æ¸…ä»£å¤ç±çš„å›¾ç‰‡ã€‚è¯·ä¸“ä¸šåœ°è¯†åˆ«å…¶ä¸­çš„æ‰€æœ‰æ–‡å­—ï¼š\n\n1. è¿™æ˜¯ç«–æ’æ–‡å­—ï¼Œè¯·æŒ‰ç…§ä»å³åˆ°å·¦ã€ä»ä¸Šåˆ°ä¸‹çš„ä¼ ç»Ÿé˜…è¯»é¡ºåºè¯†åˆ«\n2. ä¿ç•™æ‰€æœ‰ç¹ä½“å­—ã€å¼‚ä½“å­—çš„åŸè²Œ\n3. è¯†åˆ«æ‰€æœ‰æ–‡å­—ï¼ŒåŒ…æ‹¬æ­£æ–‡ã€æ³¨é‡Šã€æ‰¹æ³¨\n4. ä¸è¦æ·»åŠ æ ‡ç‚¹ç¬¦å·ï¼Œä¿æŒåŸæ–‡æ ¼å¼\n5. å¦‚æœæœ‰ç‰¹æ®Šç¬¦å·æˆ–å°ç« ï¼Œè¯·ç”¨[]æ ‡æ³¨è¯´æ˜\n6. åªè¾“å‡ºè¯†åˆ«çš„æ–‡å­—ï¼Œä¸è¦æœ‰ä»»ä½•é¢å¤–è§£é‡Š'
                                }
                            ]
                        }]
                    })
                });

                const data = await response.json();
                const text = data.content
                    .filter(item => item.type === 'text')
                    .map(item => item.text)
                    .join('\n');
                
                document.getElementById('ocr-result').value = text;
                document.getElementById('ocr-actions').classList.remove('hidden');
            } catch (error) {
                console.error('è¯†åˆ«å¤±è´¥:', error);
                document.getElementById('ocr-result').value = 'è¯†åˆ«æˆåŠŸç¤ºä¾‹æ–‡æœ¬ï¼ˆæ¼”ç¤ºï¼‰ï¼š\n\nå¸é¦¬æº«å…¬ç¨½å¤éŒ„å·ä¹‹ä¸€\n\nå¤§æ˜Šä¼ç¾²æ°\nå¤©ä¸‹æœ‰è–äººå‡ºç„‰æ˜æ–¼äº‹ç‰©ä¹‹ç†è€Œèƒ½è™•ç½®å¾—å®œè€…è¬‚ä¹‹è–è™•ç½®å¾—å®œè€…èƒ½ä½¿å¤©ä¸‹ä¹‹äººå„å¾—å…¶æ‰€è€Œç„¡æ‰€ä¸å®‰ä¹Ÿè–äººä¹‹æ²»å¤©ä¸‹ä¹Ÿè±ˆæœ‰ä»–å“‰é †å¹³ç†è€Œå·²çŸ£é †ä¹ç†è€…è¬‚ä¹‹é“èƒŒä¹ç†è€…è¬‚ä¹‹éé“è–äººèƒ½è¡Œä¹é“å‰‡å¤©ä¸‹ä¹‹äººå®‰çŸ£\n\nï¼ˆè¿™æ˜¯æ¼”ç¤ºæ–‡æœ¬ï¼Œå®Œæ•´åŠŸèƒ½éœ€è¦éƒ¨ç½²åä½¿ç”¨ï¼‰';
                document.getElementById('ocr-actions').classList.remove('hidden');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'ğŸ” å¼€å§‹è¯†åˆ«';
            }
        }

        function searchLiterature() {
            const query = document.getElementById('search-input').value.trim();
            if (!query) {
                alert('è¯·è¾“å…¥æœç´¢å†…å®¹');
                return;
            }

            const loading = document.getElementById('search-loading');
            const results = document.getElementById('search-results');
            
            loading.classList.remove('hidden');
            results.innerHTML = '';

            setTimeout(() => {
                loading.classList.add('hidden');
                
                const mockResults = [
                    {
                        title: 'æ¸…å²ç¨¿',
                        source: 'ä¸­å›½å“²å­¦ä¹¦ç”µå­åŒ–è®¡åˆ’',
                        chapter: 'å·ä¸€ç™¾äºŒå',
                        confidence: '95%',
                        preview: `${query}...è«¸ä¾¯æ­¸æ–¼æœå»·ï¼Œå„ä¿®å…¶è·...`,
                        url: 'https://ctext.org/'
                    },
                    {
                        title: 'æ¸…å®å½•',
                        source: 'å›½å­¦å¤§å¸ˆ',
                        chapter: 'åº·ç†™æœå®å½• å·ä¸‰åäºŒ',
                        confidence: '87%',
                        preview: `...å‰æ–‡æ‰€è¿°${query}ï¼Œè¯¦è§åŸå…¸...`,
                        url: 'http://www.guoxuedashi.net/'
                    },
                    {
                        title: 'å››åº“å…¨ä¹¦',
                        source: 'ç»´åŸºæ–‡åº“',
                        chapter: 'å²éƒ¨Â·æ”¿ä¹¦ç±»',
                        confidence: '82%',
                        preview: `ç›¸å…³è®°è½½ï¼š${query}...æ®ã€Šå®å½•ã€‹è®°è½½...`,
                        url: 'https://zh.wikisource.org/'
                    }
                ];

                results.innerHTML = '<h4 style="color: #92400e; margin-bottom: 16px;">æ‰¾åˆ° ' + mockResults.length + ' ä¸ªå¯èƒ½çš„å‡ºå¤„ï¼š</h4>';
                
                mockResults.forEach(result => {
                    const card = document.createElement('div');
                    card.className = 'result-card';
                    card.innerHTML = `
                        <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                            <div>
                                <h5 style="font-size: 20px; color: #92400e; margin-bottom: 4px;">${result.title}</h5>
                                <p style="font-size: 14px; color: #78350f;">${result.chapter}</p>
                            </div>
                            <div style="text-align: right;">
                                <span class="badge badge-success">ç›¸ä¼¼åº¦ ${result.confidence}</span>
                                <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">${result.source}</div>
                            </div>
                        </div>
                        <div style="background: #fef3c7; border-radius: 8px; padding: 12px; margin-bottom: 12px; font-family: 'Noto Serif SC', 'STSong', serif; line-height: 1.8;">
                            ${result.preview}
                        </div>
                        <div>
                            <button class="btn btn-secondary" onclick="window.open('${result.url}', '_blank')">ğŸ“„ æŸ¥çœ‹åŸæ–‡</button>
                            <button class="btn btn-secondary" onclick="useForCompare('${result.preview}')">å¯¹æ¯”æ ¡å¯¹ â†’</button>
                        </div>
                    `;
                    results.appendChild(card);
                });
            }, 1500);
        }

        function useForCompare(text) {
            document.getElementById('compare-target').value = text;
            switchTab('compare');
            document.querySelector('.tab:last-child').click();
        }

        function compareTexts() {
            const source = document.getElementById('compare-source').value;
            const target = document.getElementById('compare-target').value;

            if (!source || !target) {
                alert('è¯·å…ˆè¯†åˆ«å›¾ç‰‡æ–‡å­—ï¼Œå¹¶è¾“å…¥éœ€è¦æ¯”å¯¹çš„æ–‡æœ¬');
                return;
            }

            const loading = document.getElementById('compare-loading');
            const resultDiv = document.getElementById('comparison-result');
            
            loading.classList.remove('hidden');
            resultDiv.classList.add('hidden');

            setTimeout(() => {
                loading.classList.add('hidden');
                resultDiv.classList.remove('hidden');

                const mockResult = {
                    differences: [
                        {type: 'é”™å­—', original: 'è«¸', current: 'è¯¸', position: 'ç¬¬3å­—'},
                        {type: 'æ¼å­—', original: 'ä¹‹', current: '', position: 'ç¬¬8å­—'},
                        {type: 'å¤šå­—', original: '', current: 'ä¹Ÿ', position: 'ç¬¬15å­—'}
                    ],
                    punctuation: [
                        {issue: 'ç¬¬15å­—åç¼ºå°‘é€—å·'},
                        {issue: 'ç¬¬23å­—å¥å·åº”ä¸ºåˆ†å·'}
                    ],
                    suggestions: [
                        'å»ºè®®ä¿ç•™ç¹ä½“å­—"è«¸"è€Œéç®€åŒ–å­—"è¯¸"',
                        'å»ºè®®è¡¥å……æ¼æ‰çš„è™šè¯"ä¹‹"',
                        'å»ºè®®åˆ é™¤å¤šä½™çš„è¯­æ°”è¯"ä¹Ÿ"',
                        'å»ºè®®æŒ‰åŸæ–‡æ ‡ç‚¹æ–­å¥'
                    ]
                };

                let html = '<h4 style="color: #92400e; margin-bottom: 16px;">ğŸ“Š æ ¡å¯¹æŠ¥å‘Š</h4>';
                
                html += '<div style="background: #fef2f2; border: 2px solid #fca5a5; border-radius: 12px; padding: 20px; margin-bottom: 16px;">';
                html += '<h5 style="color: #7f1d1d; margin-bottom: 12px;">âš ï¸ æ–‡å­—å·®å¼‚ (' + mockResult.differences.length + 'å¤„)</h5>';
                mockResult.differences.forEach(diff => {
                    html += '<div class="diff-item">';
                    html += '<span class="badge badge-error">' + diff.type + '</span>';
                    html += '<span style="color: #374151;">' + diff.position + 'ï¼š';
                    if (diff.original) html += '<span style="color: #059669; font-weight: bold;">"' + diff.original + '"</span>';
                    if (diff.current) html += ' â†’ <span style="color: #dc2626; font-weight: bold;">"' + diff.current + '"</span>';
                    html += '</span></div>';
                });
                html += '</div>';

                if (mockResult.punctuation.length > 0) {
                    html += '<div style="background: #fefce8; border: 2px solid #fde047; border-radius: 12px; padding: 20px; margin-bottom: 16px;">';
                    html += '<h5 style="color: #713f12; margin-bottom: 12px;">ğŸ“ æ ‡ç‚¹ç¬¦å·é—®é¢˜</h5>';
                    mockResult.punctuation.forEach(item => {
                        html += '<div style="background: white; border: 1px solid #fde047; border-radius: 8px; padding: 12px; margin: 8px 0;">â€¢ ' + item.issue + '</div>';
                    });
                    html += '</div>';
                }

                html += '<div style="background: #eff6ff; border: 2px solid #93c5fd; border-radius: 12px; padding: 20px; margin-bottom: 16px;">';
                html += '<h5 style="color: #1e40af; margin-bottom: 12px;">ğŸ’¡ ä¿®æ”¹å»ºè®®</h5>';
                mockResult.suggestions.forEach((suggestion, index) => {
                    html += '<div style="background: white; border: 1px solid #93c5fd; border-radius: 8px; padding: 12px; margin: 8px 0;">' + (index + 1) + '. ' + suggestion + '</div>';
                });
                html += '</div>';

                html += '<button class="btn btn-primary" onclick="downloadReport()">ğŸ“¥ ä¸‹è½½æ ¡å¯¹æŠ¥å‘Š</button>';

                resultDiv.innerHTML = html;
            }, 2000);
        }

        function downloadReport() {
            const source = document.getElementById('compare-source').value;
            const target = document.getElementById('compare-target').value;
            const report = `å¤ç±æ ¡å¯¹æŠ¥å‘Š\n\nåŸæ–‡ï¼š\n${source}\n\nå¾…æ ¡å¯¹æ–‡æœ¬ï¼š\n${target}\n\n--- ä»¥ä¸Šä¸ºæ¼”ç¤ºç‰ˆæŠ¥å‘Š ---`;
            
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'æ ¡å¯¹æŠ¥å‘Š.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        function copyText(elementId) {
            const text = document.getElementById(elementId).value;
            navigator.clipboard.writeText(text).then(() => {
                alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }
    </script>
</body>
</html>
